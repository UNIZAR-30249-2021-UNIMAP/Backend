version: '3.8'
services:
  eureka-server:
    build: ./unimap
    restart: always
    container_name: eureka
    ports:
      - '8761:8761'

  gateway:
    build: ./gateway
    restart: always
    container_name: gateway
    ports:
      - '7000:7000'

  app-server:
    build: ./app-server
    restart: always
    container_name: app-server

  geoserver:
    image: kartoza/geoserver:2.16.2
    depends_on:
      - postgis
    ports:
      - "8080:8080"
    environment:
      - "SAMPLE_DATA=true"
    volumes:
      - geoserverdata:/opt/geoserver/data_dir

  postgis:
      image: kartoza/postgis:9.6-2.4
      ports:
        - "25432:5432"
      environment:
        - "POSTGRES_USER=unimap"
        - "POSTGRES_PASS=adminunimap123"
        - "POSTGRES_DBNAME=proyectodb"
        - "DEFAULT_ENCODING=UTF8"
      volumes:
        - dbdata:/var/lib/postgresql

volumes:
    geoserverdata:
      external: true
    dbdata:
      external: true

